<div class="row container-fluid">
	<div class="openHeader row col-xs-12">
		<h3>View Chat Records</h3>
	</div>
	<div class="row">
	    <div class="col-xs-4 openChatInfo">
		    	<h5>Page: {{ currentPage }}</h5>
		     	<h5>Total Items: {{chatData.length}}
		</div>
	    <div class="col-xs-4">
	      <label for="search">Search:</label>
	      <input ng-model="q" id="search" class="form-control" placeholder="Filter text">
	    </div>
	    <div class="col-xs-4">
	    	<div class="perPages">
		    <label for="search">items per page:</label>
		      	<select ng-model="pageSize">
		      		<option>25</option>
		      		<option>50</option>
		      		<option>75</option>
		      		<option>100</option>
		      	</select>
		    </div>
	    </div>
  	</div>
	  	<br>
	  	<div class="panel panel-default">
		    <div class="panel-body">
			    <table class="table table-striped chatTable">
				    <thead>
				      	<tr>
					        <th class="chatTableHeader">
					        	<a href="" ng-click="sortType = 'requested'; sortReverse = !sortReverse">Requested By 
					        		<span ng-show="sortType == 'requested' && !sortReverse" class="fa fa-caret-down"></span>
            						<span ng-show="sortType == 'requested' && sortReverse" class="fa fa-caret-up"></span>
					        	</a>
					        </th>
					        <th class="chatTableHeader">
					        	<a href="" ng-click="sortType = 'created'; sortReverse = !sortReverse">Created At 
					        		<span ng-show="sortType == 'created' && !sortReverse" class="fa fa-caret-down"></span>
            						<span ng-show="sortType == 'created' && sortReverse" class="fa fa-caret-up"></span>
					        	</a>
					        </th>
					        <th class="chatTableHeader">
					        	<a href="" ng-click="sortType = 'referrer'; sortReverse = !sortReverse">Referrer URL 
					        		<span ng-show="sortType == 'referrer' && !sortReverse" class="fa fa-caret-down"></span>
            						<span ng-show="sortType == 'referrer' && sortReverse" class="fa fa-caret-up"></span>
					        	</a>
					        </th>
				      	</tr>
				    </thead>
				    <tbody>
				    <tr dir-paginate="snap in chatData | orderBy:sortType:sortReverse | filter:q | itemsPerPage: pageSize" current-page="currentPage" data-toggle="modal" data-target="#myModal" ng-click="modalDetails(snap)">
				    	<td chatTableData>{{snap.requested_by}}</td>
				        <td chatTableData>{{snap.created_at | date: 'fullDate'}}</td>
				        <td chatTableData>{{snap.referrer_url || 'n/a'}}</td>
				    </tr>
			    </tbody>
			  </table>
	        <div ng-controller="paginationControl" class="other-controller">
	            	<div class="text-center">
		            	<dir-pagination-controls boundary-links="true" on-page-change="pageChangeHandler(newPageNumber)" template-url="html/dirPagination.tpl.html"></dir-pagination-controls>
	            	</div>
	        	</div>
	    	</div>
	  	</div>
	</div>
</div>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
    	<div class="modal-content">
        	<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel">Chat Record For: {{selectedUser.requested_by}}</h4>
    		</div>
	        <div class="modal-body">
	        	<div class="row">
	        		<div class="col-xs-8">
	        			<h5>ID: {{selectedUser.id}}</h5>
	        		</div>
	        		<div class="col-xs-4">
	        			<h5>Created At: {{selectedUser.created_at | date: 'mediumDate'}}</h5>
	        		</div>
	        	</div>
	        	<div class="row">
	        		<div class="col-xs-8">
	        			<p>Referrer URL: {{selectedUser.referrer_url}}</p>
	        		</div>
	        		<div class="col-xs-4">
	        			<p>IP Address: {{selectedUser.ip_address}}</p>
	        		</div>
	        	</div>
	        	<div class="row">
	        		<div class="col-xs-12">
	        			<reverse-geocode lat="{{selectedUser.latitude}}" lng="{{selectedUser.longitude}}" />
	        		</div>
	        	</div>
	        		<leaflet height="240px" width="50%"></leaflet>
	        	<div class="row">
	        		<div class="col-xs-12 chatHist" ng-repeat="chat in selectedUser.transcript">
	        			<h5>{{chat.date | date:'mediumDate'}}</h5>
	        			<p>{{chat.alias}}</p>
	        			<p>{{chat.message}}</p>
	        		</div>
	        	</div>
	        </div>
	      	<div class="modal-footer">
	        	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	        </div>
	    </div>
    </div>
</div>
